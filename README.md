# hitoDB2xlsx
人DBの情報をcsvに抽出するスクリプト

このスクリプトは、人DBの出力をファイルに保存し、そこから必要なデータを抽出してCSV (将来的にはExcel, xlsx) に出力するスクリプトです。大まかな手順としては、以下の通り

1. 人DBで検索する
2. 出力されたページ (複数ページ) をhtmlに保存する
  - Chromeなどでは Ctrl+S/Command+S などで保存
  - 【注意!!】1ページ目をChromeなどで保存すると、表示されているページではなく最初の検索ページが保存される。1ページ目を保存する際は、以下のような方法で保存すること。
    - 複数ページある場合は一旦2ページ以降に飛んで "1" をクリックして１ページ目を表示した状態で保存する
    - ブラウザの「ソースコードを表示」でソースを表示し、全選択＋内容をテキストに落とす
  - 複数ページを保存するときはファイル名がぶつからないように保存する
3. コマンドを実行し、出力ファイル (CSV) を出力する
4. Excelなどで編集

# 使い方

## 必要なパッケージのインストール

Beautiful Soupが必要なので、インストールしていなければ以下のようにしてインストールする。

```shell
$ pip install beautifulsoup4
または
$ pip3 install beautifulsoup4
```

## 実際の使い方

現在のところオプションはなく、以下のように出力ファイル、入力ファイルを引数に与えて実行する。

```shell
$ hitoDB2xlsx <出力csvファイル名> <入力html....>
または
$ python3 hitoDB2xlsx <出力csvファイル名> <入力html....>

```

たとえば、

```shell
$ hitoDB2xlsx output.csv *.html
```

のように実行すれば、カレントディレクトリ内のすべてのHTMLファイルをスキャンして、output.csv ファイルに出力する。すでにoutput.csv ファイルがあれば、上書きされる。



